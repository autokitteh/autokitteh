import{M as S,p as V,a as ie}from"./@bufbuild-Bqv04oZs.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="fad2fa4e-6d21-4900-9bfc-653b2ab5ef03",e._sentryDebugIdIdentifier="sentry-dbid-fad2fa4e-6d21-4900-9bfc-653b2ab5ef03")}catch{}})();var y;(function(e){e[e.Canceled=1]="Canceled",e[e.Unknown=2]="Unknown",e[e.InvalidArgument=3]="InvalidArgument",e[e.DeadlineExceeded=4]="DeadlineExceeded",e[e.NotFound=5]="NotFound",e[e.AlreadyExists=6]="AlreadyExists",e[e.PermissionDenied=7]="PermissionDenied",e[e.ResourceExhausted=8]="ResourceExhausted",e[e.FailedPrecondition=9]="FailedPrecondition",e[e.Aborted=10]="Aborted",e[e.OutOfRange=11]="OutOfRange",e[e.Unimplemented=12]="Unimplemented",e[e.Internal=13]="Internal",e[e.Unavailable=14]="Unavailable",e[e.DataLoss=15]="DataLoss",e[e.Unauthenticated=16]="Unauthenticated"})(y||(y={}));function R(e){const t=y[e];return typeof t!="string"?e.toString():t[0].toLowerCase()+t.substring(1).replace(/[A-Z]/g,r=>"_"+r.toLowerCase())}let T;function oe(e){if(!T){T={};for(const t of Object.values(y))typeof t!="string"&&(T[R(t)]=t)}return T[e]}class b extends Error{constructor(t,r=y.Unknown,a,n,i){super(se(t,r)),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=t,this.code=r,this.metadata=new Headers(a??{}),this.details=n??[],this.cause=i}static from(t,r=y.Unknown){return t instanceof b?t:t instanceof Error?t.name=="AbortError"?new b(t.message,y.Canceled):new b(t.message,r,void 0,void 0,t):new b(String(t),r,void 0,void 0,t)}static[Symbol.hasInstance](t){return t instanceof Error?Object.getPrototypeOf(t)===b.prototype?!0:t.name==="ConnectError"&&"code"in t&&typeof t.code=="number"&&"metadata"in t&&"details"in t&&Array.isArray(t.details)&&"rawMessage"in t&&typeof t.rawMessage=="string"&&"cause"in t:!1}findDetails(t){const r="typeName"in t?{findMessage:n=>n===t.typeName?t:void 0}:t,a=[];for(const n of this.details){if("getType"in n){r.findMessage(n.getType().typeName)&&a.push(n);continue}const i=r.findMessage(n.type);if(i)try{a.push(i.fromBinary(n.value))}catch{}}return a}}function se(e,t){return e.length?`[${R(t)}] ${e}`:`[${R(t)}]`}function ce(...e){const t=new Headers;for(const r of e)r.forEach((a,n)=>{t.append(n,a)});return t}function ue(e,t){const r={};for(const[a,n]of Object.entries(e.methods)){const i=t(Object.assign(Object.assign({},n),{localName:a,service:e}));i!=null&&(r[a]=i)}return r}function le(e){let t,r=new Uint8Array(0);function a(n){const i=new Uint8Array(r.length+n.length);i.set(r),i.set(n,r.length),r=i}return new ReadableStream({start(){t=e.getReader()},async pull(n){let i;for(;;){if(i===void 0&&r.byteLength>=5){let u=0;for(let d=1;d<5;d++)u=(u<<8)+r[d];i={flags:r[0],length:u}}if(i!==void 0&&r.byteLength>=i.length+5)break;const c=await t.read();if(c.done)break;a(c.value)}if(i===void 0){if(r.byteLength==0){n.close();return}n.error(new b("premature end of stream",y.DataLoss));return}const o=r.subarray(5,5+i.length);r=r.subarray(5+i.length),n.enqueue({flags:i.flags,data:o})}})}function de(e,t){const r=new Uint8Array(t.length+5);r.set(t,5);const a=new DataView(r.buffer,r.byteOffset,r.byteLength);return a.setUint8(0,e),a.setUint32(1,t.length),r}var fe=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r);function a(i){r[i]=e[i]&&function(o){return new Promise(function(c,u){o=e[i](o),n(c,u,o.done,o.value)})}}function n(i,o,c,u){Promise.resolve(u).then(function(d){i({value:d,done:c})},o)}},E=function(e){return this instanceof E?(this.v=e,this):new E(e)},ye=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r.apply(e,t||[]),n,i=[];return n={},c("next"),c("throw"),c("return",o),n[Symbol.asyncIterator]=function(){return this},n;function o(s){return function(l){return Promise.resolve(l).then(s,m)}}function c(s,l){a[s]&&(n[s]=function(f){return new Promise(function(h,p){i.push([s,f,h,p])>1||u(s,f)})},l&&(n[s]=l(n[s])))}function u(s,l){try{d(a[s](l))}catch(f){v(i[0][3],f)}}function d(s){s.value instanceof E?Promise.resolve(s.value.v).then(g,m):v(i[0][2],s)}function g(s){u("next",s)}function m(s){u("throw",s)}function v(s,l){s(l),i.shift(),i.length&&u(i[0][0],i[0][1])}},he=function(e){var t,r;return t={},a("next"),a("throw",function(n){throw n}),a("return"),t[Symbol.iterator]=function(){return this},t;function a(n,i){t[n]=e[n]?function(o){return(r=!r)?{value:E(e[n](o)),done:!1}:i?i(o):o}:i}};function ge(e){return ye(this,arguments,function*(){yield E(yield*he(fe(e)))})}var W=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r);function a(i){r[i]=e[i]&&function(o){return new Promise(function(c,u){o=e[i](o),n(c,u,o.done,o.value)})}}function n(i,o,c,u){Promise.resolve(u).then(function(d){i({value:d,done:c})},o)}},I=function(e){return this instanceof I?(this.v=e,this):new I(e)},me=function(e){var t,r;return t={},a("next"),a("throw",function(n){throw n}),a("return"),t[Symbol.iterator]=function(){return this},t;function a(n,i){t[n]=e[n]?function(o){return(r=!r)?{value:I(e[n](o)),done:!1}:i?i(o):o}:i}},be=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r.apply(e,t||[]),n,i=[];return n={},c("next"),c("throw"),c("return",o),n[Symbol.asyncIterator]=function(){return this},n;function o(s){return function(l){return Promise.resolve(l).then(s,m)}}function c(s,l){a[s]&&(n[s]=function(f){return new Promise(function(h,p){i.push([s,f,h,p])>1||u(s,f)})},l&&(n[s]=l(n[s])))}function u(s,l){try{d(a[s](l))}catch(f){v(i[0][3],f)}}function d(s){s.value instanceof I?Promise.resolve(s.value.v).then(g,m):v(i[0][2],s)}function g(s){u("next",s)}function m(s){u("throw",s)}function v(s,l){s(l),i.shift(),i.length&&u(i[0][0],i[0][1])}};function Be(e,t){return ue(e,r=>{switch(r.kind){case S.Unary:return ve(t,e,r);case S.ServerStreaming:return we(t,e,r);case S.ClientStreaming:return pe(t,e,r);case S.BiDiStreaming:return Se(t,e,r);default:return null}})}function ve(e,t,r){return async function(a,n){var i,o;const c=await e.unary(t,r,n==null?void 0:n.signal,n==null?void 0:n.timeoutMs,n==null?void 0:n.headers,a,n==null?void 0:n.contextValues);return(i=n==null?void 0:n.onHeader)===null||i===void 0||i.call(n,c.header),(o=n==null?void 0:n.onTrailer)===null||o===void 0||o.call(n,c.trailer),c.message}}function we(e,t,r){return function(a,n){return K(e.stream(t,r,n==null?void 0:n.signal,n==null?void 0:n.timeoutMs,n==null?void 0:n.headers,ge([a]),n==null?void 0:n.contextValues),n)}}function pe(e,t,r){return async function(a,n){var i,o,c,u,d,g;const m=await e.stream(t,r,n==null?void 0:n.signal,n==null?void 0:n.timeoutMs,n==null?void 0:n.headers,a,n==null?void 0:n.contextValues);(d=n==null?void 0:n.onHeader)===null||d===void 0||d.call(n,m.header);let v;try{for(var s=!0,l=W(m.message),f;f=await l.next(),i=f.done,!i;s=!0)u=f.value,s=!1,v=u}catch(h){o={error:h}}finally{try{!s&&!i&&(c=l.return)&&await c.call(l)}finally{if(o)throw o.error}}if(!v)throw new b("protocol error: missing response message",y.Internal);return(g=n==null?void 0:n.onTrailer)===null||g===void 0||g.call(n,m.trailer),v}}function Se(e,t,r){return function(a,n){return K(e.stream(t,r,n==null?void 0:n.signal,n==null?void 0:n.timeoutMs,n==null?void 0:n.headers,a,n==null?void 0:n.contextValues),n)}}function K(e,t){const r=function(){var a,n;return be(this,arguments,function*(){const i=yield I(e);(a=t==null?void 0:t.onHeader)===null||a===void 0||a.call(t,i.header),yield I(yield*me(W(i.message))),(n=t==null?void 0:t.onTrailer)===null||n===void 0||n.call(t,i.trailer)})}()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>r.next()})}}function _e(...e){const t=new AbortController,r=e.filter(n=>n!==void 0).concat(t.signal);for(const n of r){if(n.aborted){a.apply(n);break}n.addEventListener("abort",a)}function a(){t.signal.aborted||t.abort(Z(this));for(const n of r)n.removeEventListener("abort",a)}return t}function Ie(e){const t=new AbortController,r=()=>{t.abort(new b("the operation timed out",y.DeadlineExceeded))};let a;return e!==void 0&&(e<=0?r():a=setTimeout(r,e)),{signal:t.signal,cleanup:()=>clearTimeout(a)}}function Z(e){if(!e.aborted)return;if(e.reason!==void 0)return e.reason;const t=new Error("This operation was aborted");return t.name="AbortError",t}function H(){return{get(e){return e.id in this?this[e.id]:e.defaultValue},set(e,t){return this[e.id]=t,this},delete(e){return delete this[e.id],this}}}function L(e,t,r){const a=typeof t=="string"?t:t.typeName,n=typeof r=="string"?r:r.name;return e.toString().replace(/\/?$/,`/${a}/${n}`)}function Q(e,t){return t instanceof e?t:new e(t)}function xe(e,t){function r(a){return a.done===!0?a:{done:a.done,value:Q(e,a.value)}}return{[Symbol.asyncIterator](){const a=t[Symbol.asyncIterator](),n={next:()=>a.next().then(r)};return a.throw!==void 0&&(n.throw=i=>a.throw(i).then(r)),a.return!==void 0&&(n.return=i=>a.return(i).then(r)),n}}}function X(e,t){var r;return(r=t==null?void 0:t.concat().reverse().reduce((a,n)=>n(a),e))!==null&&r!==void 0?r:e}function Y(e){var t;const r=Object.assign({},e);return(t=r.ignoreUnknownFields)!==null&&t!==void 0||(r.ignoreUnknownFields=!0),r}function z(e,t,r,a){const n=t?N(e.I,a):k(e.I,r);return{parse:(t?N(e.O,a):k(e.O,r)).parse,serialize:n.serialize}}function N(e,t){return{parse(r){try{return e.fromBinary(r,t)}catch(a){const n=a instanceof Error?a.message:String(a);throw new b(`parse binary: ${n}`,y.InvalidArgument)}},serialize(r){try{return r.toBinary(t)}catch(a){const n=a instanceof Error?a.message:String(a);throw new b(`serialize binary: ${n}`,y.Internal)}}}}function k(e,t){var r,a;const n=(r=t==null?void 0:t.textEncoder)!==null&&r!==void 0?r:new TextEncoder,i=(a=t==null?void 0:t.textDecoder)!==null&&a!==void 0?a:new TextDecoder,o=Y(t);return{parse(c){try{const u=i.decode(c);return e.fromJsonString(u,o)}catch(u){throw b.from(u,y.InvalidArgument)}},serialize(c){try{const u=c.toJsonString(o);return n.encode(u)}catch(u){throw b.from(u,y.Internal)}}}}const Ee=/^application\/(connect\+)?(?:(json)(?:; ?charset=utf-?8)?|(proto))$/i,Oe="application/proto",Ae="application/json",Ue="application/connect+proto",Te="application/connect+json";function je(e){const t=e==null?void 0:e.match(Ee);if(!t)return;const r=!!t[1],a=!!t[3];return{stream:r,binary:a}}function ee(e,t,r){if(t&&new Headers(t).forEach((o,c)=>r.metadata.append(c,o)),typeof e!="object"||e==null||Array.isArray(e)||!("code"in e)||typeof e.code!="string")throw r;const a=oe(e.code);if(a===void 0)throw r;const n=e.message;if(n!=null&&typeof n!="string")throw r;const i=new b(n??"",a,t);if("details"in e&&Array.isArray(e.details))for(const o of e.details){if(o===null||typeof o!="object"||Array.isArray(o)||typeof o.type!="string"||typeof o.value!="string"||"debug"in o&&typeof o.debug!="object")throw r;try{i.details.push({type:o.type,value:V.dec(o.value),debug:o.debug})}catch{throw r}}return i}const G=2;function Pe(e){const t=new b("invalid end stream",y.InvalidArgument);let r;try{r=JSON.parse(typeof e=="string"?e:new TextDecoder().decode(e))}catch{throw t}if(typeof r!="object"||r==null||Array.isArray(r))throw t;const a=new Headers;if("metadata"in r){if(typeof r.metadata!="object"||r.metadata==null||Array.isArray(r.metadata))throw t;for(const[i,o]of Object.entries(r.metadata)){if(!Array.isArray(o)||o.some(c=>typeof c!="string"))throw t;for(const c of o)a.append(i,c)}}const n="error"in r?ee(r.error,a,t):void 0;return{metadata:a,error:n}}const F="Content-Type",De="Content-Length",J="Content-Encoding",Re="Accept-Encoding",Fe="Connect-Timeout-Ms",ne="Connect-Protocol-Version";function $e(e){switch(e){case 400:return y.InvalidArgument;case 401:return y.Unauthenticated;case 403:return y.PermissionDenied;case 404:return y.Unimplemented;case 408:return y.DeadlineExceeded;case 409:return y.Aborted;case 412:return y.FailedPrecondition;case 413:return y.ResourceExhausted;case 415:return y.Internal;case 429:return y.Unavailable;case 431:return y.ResourceExhausted;case 502:return y.Unavailable;case 503:return y.Unavailable;case 504:return y.Unavailable;default:return y.Unknown}}function B(e){const t=new Headers,r=new Headers;return e.forEach((a,n)=>{n.toLowerCase().startsWith("trailer-")?r.set(n.substring(8),a):t.set(n,a)}),[t,r]}const te="1";function M(e,t,r,a,n){const i=new Headers(a??{});return r!==void 0&&i.set(Fe,`${r}`),i.set(F,e==S.Unary?t?Oe:Ae:t?Ue:Te),i.set(ne,te),i}function q(e,t,r){const a=r.get("Content-Type"),n=je(a);if(t!==200){const i=new b(`HTTP ${t}`,$e(t),r);if(e==S.Unary&&n&&!n.binary)return{isUnaryError:!0,unaryError:i};throw i}return{isUnaryError:!1}}const C="application/";function He(e,t){return t?V.enc(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):encodeURIComponent(new TextDecoder().decode(e))}function Le(e,t,r){let a=`?connect=v${te}`;const n=e.header.get(F);(n==null?void 0:n.indexOf(C))===0&&(a+="&encoding="+encodeURIComponent(n.slice(C.length)));const i=e.header.get(J);i!==null&&i!=="identity"&&(a+="&compression="+encodeURIComponent(i),r=!0),r&&(a+="&base64=1"),a+="&message="+He(t,r);const o=e.url+a,c=new Headers(e.header);return[ne,F,De,J,Re].forEach(u=>c.delete(u)),Object.assign(Object.assign({},e),{init:Object.assign(Object.assign({},e.init),{method:"GET"}),url:o,header:c})}function ze(e){const t=X(e.next,e.interceptors),[r,a,n]=re(e),i=Object.assign(Object.assign({},e.req),{message:Q(e.req.method.I,e.req.message),signal:r});return t(i).then(o=>(n(),o),a)}function Ne(e){const t=X(e.next,e.interceptors),[r,a,n]=re(e),i=Object.assign(Object.assign({},e.req),{message:xe(e.req.method.I,e.req.message),signal:r});let o=!1;return r.addEventListener("abort",function(){var c,u;const d=e.req.message[Symbol.asyncIterator]();o||(c=d.throw)===null||c===void 0||c.call(d,this.reason).catch(()=>{}),(u=d.return)===null||u===void 0||u.call(d).catch(()=>{})}),t(i).then(c=>Object.assign(Object.assign({},c),{message:{[Symbol.asyncIterator](){const u=c.message[Symbol.asyncIterator]();return{next(){return u.next().then(d=>(d.done==!0&&(o=!0,n()),d),a)}}}}}),a)}function re(e){const{signal:t,cleanup:r}=Ie(e.timeoutMs),a=_e(e.signal,t);return[a.signal,function(i){const o=b.from(t.aborted?Z(t):i);return a.abort(o),r(),Promise.reject(o)},function(){r(),a.abort()}]}function ke(){try{new Headers}catch{throw new Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}var O=function(e){return this instanceof O?(this.v=e,this):new O(e)},Ge=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r.apply(e,t||[]),n,i=[];return n={},c("next"),c("throw"),c("return",o),n[Symbol.asyncIterator]=function(){return this},n;function o(s){return function(l){return Promise.resolve(l).then(s,m)}}function c(s,l){a[s]&&(n[s]=function(f){return new Promise(function(h,p){i.push([s,f,h,p])>1||u(s,f)})},l&&(n[s]=l(n[s])))}function u(s,l){try{d(a[s](l))}catch(f){v(i[0][3],f)}}function d(s){s.value instanceof O?Promise.resolve(s.value.v).then(g,m):v(i[0][2],s)}function g(s){u("next",s)}function m(s){u("throw",s)}function v(s,l){s(l),i.shift(),i.length&&u(i[0][0],i[0][1])}};function Me(e){var t;ke();const r=(t=e.useBinaryFormat)!==null&&t!==void 0?t:!1;return{async unary(a,n,i,o,c,u,d){var g;const{serialize:m,parse:v}=z(n,r,e.jsonOptions,e.binaryOptions);return o=o===void 0?e.defaultTimeoutMs:o<=0?void 0:o,await ze({interceptors:e.interceptors,signal:i,timeoutMs:o,req:{stream:!1,service:a,method:n,url:L(e.baseUrl,a,n),init:{method:"POST",credentials:(g=e.credentials)!==null&&g!==void 0?g:"same-origin",redirect:"error",mode:"cors"},header:M(n.kind,r,o,c),contextValues:d??H(),message:u},next:async s=>{var l;const f=e.useHttpGet===!0&&n.idempotency===ie.NoSideEffects;let h=null;f?s=Le(s,m(s.message),r):h=m(s.message);const w=await((l=e.fetch)!==null&&l!==void 0?l:globalThis.fetch)(s.url,Object.assign(Object.assign({},s.init),{headers:s.header,signal:s.signal,body:h})),{isUnaryError:_,unaryError:x}=q(n.kind,w.status,w.headers);if(_)throw ee(await w.json(),ce(...B(w.headers)),x);const[A,j]=B(w.headers);return{stream:!1,service:a,method:n,header:A,message:r?v(new Uint8Array(await w.arrayBuffer())):n.O.fromJson(await w.json(),Y(e.jsonOptions)),trailer:j}}})},async stream(a,n,i,o,c,u,d){var g;const{serialize:m,parse:v}=z(n,r,e.jsonOptions,e.binaryOptions);function s(f,h,p){return Ge(this,arguments,function*(){const _=le(f).getReader();let x=!1;for(;;){const A=yield O(_.read());if(A.done)break;const{flags:j,data:$}=A.value;if((j&G)===G){x=!0;const P=Pe($);if(P.error){const U=P.error;throw p.forEach((D,ae)=>{U.metadata.append(ae,D)}),U}P.metadata.forEach((U,D)=>h.set(D,U));continue}yield yield O(v($))}if(!x)throw"missing EndStreamResponse"})}async function l(f){if(n.kind!=S.ServerStreaming)throw"The fetch API does not support streaming request bodies";const h=await f[Symbol.asyncIterator]().next();if(h.done==!0)throw"missing request message";return de(0,m(h.value))}return o=o===void 0?e.defaultTimeoutMs:o<=0?void 0:o,await Ne({interceptors:e.interceptors,timeoutMs:o,signal:i,req:{stream:!0,service:a,method:n,url:L(e.baseUrl,a,n),init:{method:"POST",credentials:(g=e.credentials)!==null&&g!==void 0?g:"same-origin",redirect:"error",mode:"cors"},header:M(n.kind,r,o,c),contextValues:d??H(),message:u},next:async f=>{var h;const w=await((h=e.fetch)!==null&&h!==void 0?h:globalThis.fetch)(f.url,Object.assign(Object.assign({},f.init),{headers:f.header,signal:f.signal,body:await l(f.message)}));if(q(n.kind,w.status,w.headers),w.body===null)throw"missing response body";const _=new Headers;return Object.assign(Object.assign({},f),{header:w.headers,trailer:_,message:s(w.body,_,w.headers)})}})}}}export{b as C,y as a,Be as b,Me as c};

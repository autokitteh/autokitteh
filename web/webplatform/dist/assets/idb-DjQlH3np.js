(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new e.Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="b6bd13e6-b190-472f-903e-a2dfcc74426b",e._sentryDebugIdIdentifier="sentry-dbid-b6bd13e6-b190-472f-903e-a2dfcc74426b")}catch{}})();const h=(e,n)=>n.some(t=>e instanceof t);let m,B;function C(){return m||(m=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function x(){return B||(B=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const b=new WeakMap,y=new WeakMap,f=new WeakMap;function p(e){const n=new Promise((t,r)=>{const i=()=>{e.removeEventListener("success",c),e.removeEventListener("error",o)},c=()=>{t(d(e.result)),i()},o=()=>{r(e.error),i()};e.addEventListener("success",c),e.addEventListener("error",o)});return f.set(n,e),n}function S(e){if(b.has(e))return;const n=new Promise((t,r)=>{const i=()=>{e.removeEventListener("complete",c),e.removeEventListener("error",o),e.removeEventListener("abort",o)},c=()=>{t(),i()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",c),e.addEventListener("error",o),e.addEventListener("abort",o)});b.set(e,n)}let l={get(e,n,t){if(e instanceof IDBTransaction){if(n==="done")return b.get(e);if(n==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return d(e[n])},set(e,n,t){return e[n]=t,!0},has(e,n){return e instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in e}};function P(e){l=e(l)}function T(e){return x().includes(e)?function(...n){return e.apply(D(this),n),d(this.request)}:function(...n){return d(e.apply(D(this),n))}}function V(e){return typeof e=="function"?T(e):(e instanceof IDBTransaction&&S(e),h(e,C())?new Proxy(e,l):e)}function d(e){if(e instanceof IDBRequest)return p(e);if(y.has(e))return y.get(e);const n=V(e);return n!==e&&(y.set(e,n),f.set(n,e)),n}const D=e=>f.get(e);function k(e,n,{blocked:t,upgrade:r,blocking:i,terminated:c}={}){const o=indexedDB.open(e,n),u=d(o);return r&&o.addEventListener("upgradeneeded",s=>{r(d(o.result),s.oldVersion,s.newVersion,d(o.transaction),s)}),t&&o.addEventListener("blocked",s=>t(s.oldVersion,s.newVersion,s)),u.then(s=>{c&&s.addEventListener("close",()=>c()),i&&s.addEventListener("versionchange",a=>i(a.oldVersion,a.newVersion,a))}).catch(()=>{}),u}const j=["get","getKey","getAll","getAllKeys","count"],v=["put","add","delete","clear"],I=new Map;function g(e,n){if(!(e instanceof IDBDatabase&&!(n in e)&&typeof n=="string"))return;if(I.get(n))return I.get(n);const t=n.replace(/FromIndex$/,""),r=n!==t,i=v.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||j.includes(t)))return;const c=async function(o,...u){const s=this.transaction(o,i?"readwrite":"readonly");let a=s.store;return r&&(a=a.index(u.shift())),(await Promise.all([a[t](...u),i&&s.done]))[0]};return I.set(n,c),c}P(e=>({...e,get:(n,t,r)=>g(n,t)||e.get(n,t,r),has:(n,t)=>!!g(n,t)||e.has(n,t)}));const A=["continue","continuePrimaryKey","advance"],E={},w=new WeakMap,L=new WeakMap,O={get(e,n){if(!A.includes(n))return e[n];let t=E[n];return t||(t=E[n]=function(...r){w.set(this,L.get(this)[n](...r))}),t}};async function*W(...e){let n=this;if(n instanceof IDBCursor||(n=await n.openCursor(...e)),!n)return;n=n;const t=new Proxy(n,O);for(L.set(t,n),f.set(t,D(n));n;)yield t,n=await(w.get(t)||n.continue()),w.delete(t)}function M(e,n){return n===Symbol.asyncIterator&&h(e,[IDBIndex,IDBObjectStore,IDBCursor])||n==="iterate"&&h(e,[IDBIndex,IDBObjectStore])}P(e=>({...e,get(n,t,r){return M(n,t)?W:e.get(n,t,r)},has(n,t){return M(n,t)||e.has(n,t)}}));export{k as o};

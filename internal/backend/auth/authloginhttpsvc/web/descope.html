<!DOCTYPE html>

<html>

<head>
  <title>Login</title>
  <script src="/static/descope-web-component.js"></script>
</head>

<body>
  <div style="max-width: 500px; margin: auto;">
    <descope-wc project-id="{{ .ProjectID }}" flow-id="sign-up-or-in" theme="os"></descope-wc>
  </div>

  <script>
    const onSuccess = async (e) => {
      // Use service URL if configured, otherwise use current origin (for backward compatibility)
      const serviceURL = "{{ .ServiceURL }}";
      const baseURL = serviceURL || window.location.origin;
      const url = new URL('/auth/descope/login', baseURL);
      url.searchParams.set('jwt', e.detail.sessionJwt);
      window.location.replace(url.toString());
    }

    const onError = (err) => console.error(err);

    const wcElement = document.getElementsByTagName("descope-wc")[0];
    wcElement.addEventListener("success", onSuccess);
    wcElement.addEventListener("error", onError);
  </script>
</body>

</html>
